"0","process_articles <- function(df) {"
"0","  # First group by article identifiers and concatenate sentences"
"0","  # Using filename as the identifier, but you might need to use other columns"
"0","  compiled_df <- df %>%"
"0","    group_by(filename) %>%"
"0","    summarize("
"0","      # Combine all non-NA sentences"
"0","      sentence = paste(na.omit(sentence), collapse = "" ""),"
"0","      # Keep one value for each of the other columns"
"0","      # consolidating metadata into single row per article"
"0","      title = first(title),"
"0","      abstract = first(abstract),"
"0","      store_id = first(store_id),"
"0","      article_type = first(article_type),"
"0","      authors = first(authors),"
"0","      copyright = first(copyright),"
"0","      document_type = first(document_type),"
"0","      entry_date = first(entry_date),"
"0","      issn = first(issn),"
"0","      issue = first(issue),"
"0","      language = first(language),"
"0","      language_of_summary = first(language_of_summary),"
"0","      pages = first(pages),"
"0","      place_of_publication = first(place_of_publication),"
"0","      pubdate = first(pubdate),"
"0","      pubtitle = first(pubtitle),"
"0","      year = first(year),"
"0","      volume = first(volume),"
"0","      document_url = first(document_url),"
"0","      document_features = first(document_features),"
"0","      start_page = first(start_page),"
"0","      find_a_copy = first(find_a_copy),"
"0","      database = first(database),"
"0","      date = first(date)"
"0","    )"
"0","  "
"0","  # Remove punctuation and spaces from the sentence column"
"0","  compiled_df <- compiled_df %>%"
"0","    mutate(sentence = str_replace_all(sentence, ""[[:punct:][:space:]]"", """")) |> "
"0","    mutate(sentence = tolower(sentence))"
"0","  "
"0","  return(compiled_df)"
"0","}"
"0",""
"0","# Apply the function to your dataframe"
"0","processed_llm_text <- process_articles(llm_text)"
"0",""
"0","# Prepare data with filenames and content"
"0","articles_for_analysis <- processed_llm_text %>%"
"0","  select(filename, sentence) %>%"
"0","  mutate(article_data = paste(""FILENAME:"", filename, ""\nCONTENT:"", sentence))"
"0",""
"0","# Combine with clear separators"
"0","combined_text_with_filenames <- paste(articles_for_analysis$article_data, "
"0","                                    collapse = ""\n\n---ARTICLE SEPARATOR---\n\n"")"
