"0","process_articles <- function(df) {"
"0","  # First group by article identifiers and concatenate sentences"
"0","  # Using filename as the identifier, but you might need to use other columns"
"0","  compiled_df <- df %>%"
"0","    group_by(filename) %>%"
"0","    summarize("
"0","      # Combine all non-NA sentences"
"0","      sentence = paste(na.omit(sentence), collapse = "" ""),"
"0","      # Keep one value for each of the other columns"
"0","      # consolidating metadata into single row per article"
"0","      title                  = first(title),"
"0","      published_date         = first(published_date),"
"0","      publication_location   = first(publication_location),"
"0","      publication_4          = first(publication_4),"
"0","      publication_type_5     = first(publication_type_5),"
"0","      length                 = first(length),"
"0","      section                = first(section),"
"0","      word_count             = first(word_count),"
"0","      countries              = first(countries),"
"0","      byline                 = first(byline),"
"0","      agg_copyright          = first(agg_copyright),"
"0","      cite                   = first(cite),"
"0","      company                = first(company),"
"0","      headline               = first(headline),"
"0","      hlead                  = first(hlead),"
"0","      publication_16         = first(publication_16),"
"0","      publication_type_17    = first(publication_type_17),"
"0","      pub_copyright          = first(pub_copyright),"
"0","      show                   = first(show),"
"0","      term                   = first(term),"
"0","      ticker                 = first(ticker),"
"0","      index                  = first(index),"
"0","      filepath               = first(filepath),"
"0","      date                   = first(date),"
"0","      year                   = first(year),"
"0","      .groups = ""drop"""
"0","    )"
"0","  "
"0","  # Remove punctuation and spaces from the sentence column"
"0","  compiled_df <- compiled_df %>%"
"0","    mutate(sentence = str_replace_all(sentence, ""[[:punct:][:space:]]"", """")) |> "
"0","    mutate(sentence = tolower(sentence))"
"0","  "
"0","  return(compiled_df)"
"0","}"
"0",""
"0","# Apply the function to your dataframe"
"0","processed_llm_text <- process_articles(llm_text)"
"0",""
"0","# Prepare data with filenames and content"
"0","articles_for_analysis <- processed_llm_text %>%"
"0","  select(filename, sentence) %>%"
"0","  mutate(article_data = paste(""FILENAME:"", filename, ""\nCONTENT:"", sentence))"
"0",""
"0","# Combine with clear separators"
"0","combined_text_with_filenames <- paste(articles_for_analysis$article_data, "
"0","                                    collapse = ""\n\n---ARTICLE SEPARATOR---\n\n"")"
